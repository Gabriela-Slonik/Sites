<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Árvores AVL</title>
<link rel="stylesheet" href="../css/style.css">
</head>
<body>
<header><h1>Árvore AVL</h1></header>

<main class="conteudo">
<p>Adicione números e veja o balanceamento da árvore AVL.</p>
<input id="num" type="number" placeholder="Número">
<button onclick="inserir()">Inserir</button>
<pre id="arvore"></pre>

<script>
let raiz = null;

class No {
  constructor(v) { this.v = v; this.e = null; this.d = null; this.h = 1; }
}

function altura(n) { return n ? n.h : 0; }

function rotDir(y) {
  let x = y.e;
  let T = x.d;
  x.d = y;
  y.e = T;
  y.h = Math.max(altura(y.e), altura(y.d)) + 1;
  x.h = Math.max(altura(x.e), altura(x.d)) + 1;
  return x;
}

function rotEsq(x) {
  let y = x.d;
  let T = y.e;
  y.e = x;
  x.d = T;
  x.h = Math.max(altura(x.e), altura(x.d)) + 1;
  y.h = Math.max(altura(y.e), altura(y.d)) + 1;
  return y;
}

function inserirAVL(n, v) {
  if (!n) return new No(v);
  if (v < n.v) n.e = inserirAVL(n.e, v);
  else n.d = inserirAVL(n.d, v);

  n.h = Math.max(altura(n.e), altura(n.d)) + 1;
  let fb = altura(n.e) - altura(n.d);

  if (fb > 1 && v < n.e.v) return rotDir(n);
  if (fb < -1 && v > n.d.v) return rotEsq(n);
  if (fb > 1 && v > n.e.v) { n.e = rotEsq(n.e); return rotDir(n); }
  if (fb < -1 && v < n.d.v) { n.d = rotDir(n.d); return rotEsq(n); }
  return n;
}

function inserir() {
  const v = parseInt(document.getElementById('num').value);
  raiz = inserirAVL(raiz, v);
  document.getElementById('arvore').innerText = desenhar(raiz);
}

function desenhar(n, nivel=0) {
  if (!n) return "";
  return desenhar(n.d, nivel+1) + " ".repeat(nivel*4) + n.v + "\n" + desenhar(n.e, nivel+1);
}
</script>
</main>

<footer><a href="../index.html/index.html" class="voltar">← Voltar</a></footer>
</body>
</html>

